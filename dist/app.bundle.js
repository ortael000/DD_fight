(()=>{function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var a=e((function t(e,a,n,o,r,i,c,p,s,d,l,h,u,_,m,f,g,k,v,y){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.HP=a,this.CA=n,this.Init=o,this.attack1=r,this.attack1_touch=i,this.attack1_min=c,this.attack1_max=p,this.attack1_proba=s,this.attack2=d,this.attack2_touch=l,this.attack2_min=h,this.attack2_max=u,this.attack2_proba=_,this.drop_xp=m,this.drop_coin=f,this.drop_object1=g,this.proba1=k,this.drop_object2=v,this.proba2=y})),n=[],o=new a("gothir_soldier",16,12,2,"sword blow",3,3,9,.7,"furious charge",0,5,12,.3,320,40,"epee courte en fer",.5,"tresor gothir 1",.1);n.push(o);var r=new a("gothir_archer",14,2,5,"arrow",3,2,7,1,0,0,0,0,0,340,45,"5 x fleche en fer",.5,"tresor gothir 1",.1);n.push(r);var i=new a("gothir_sergeant",20,14,3,"masse blow",5,5,10,.7,"Break the knees and inflict - 3 CA for the rest of the fight",3,5,10,.3,550,60,"tresor gothir 1",.3,"Iron mace",.7);n.push(i);var c=new a("gothir_knight",26,17,5,"sword blow",7,5,12,.6,"defensive blow (+4 CA until next turn)",4,4,10,.4,900,120,"tresor gothir 1",.6,"Gothir tresor 2",.2);n.push(c);var p=new a("gothir_royal_guard",32,19,7,"sword blow",9,8,15,.6,"defensive blow (+4 CA until next turn)",7,7,13,.4,1500,200,"tresor gothir 1",.8,"Gothir tresor 2",.4);n.push(p);var s=n.length,d=document.getElementById("add_opponent"),l=document.getElementById("opponent_input"),h=document.getElementById("opponents_display"),u=document.getElementById("opponent_number"),_=document.getElementById("add_character"),m=document.getElementById("character_name_input"),f=document.getElementById("character_init_input"),g=document.getElementById("character_hp_input"),k=0,v=[],y=document.getElementById("battle_order"),b=document.getElementById("attack_text_barre"),E=document.getElementById("generate_loot");d.addEventListener("click",(function(){++k,u.innerText=k;var t,e,o,r=function(t){for(var e=0;e<s;e++)if(n[e].name==t)return e}(l.value),i=(t=n[r],e=k,o=Math.floor(20*Math.random()+1)+t.Init,new a(t.name+e,t.HP,t.CA,o,t.attack1,t.attack1_touch,t.attack1_min,t.attack1_max,t.attack1_proba,t.attack2,t.attack2_touch,t.attack2_min,t.attack2_max,t.attack2_proba,t.drop_xp,t.drop_coin,t.drop_object1,t.proba1,t.drop_object2,t.proba2));v.push(i),console.log("This "+i.name+" has an initiative of "+v[k-1].Init);var c=document.createElement("div");h.appendChild(c),c.classList.add("present_opponent"),c.innerHTML=l.value})),_.addEventListener("click",(function(){++k,u.innerText=k;var t=m.value,e=f.value,n=g.value;v.push(new a(t,n,0,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));var o=document.createElement("div");h.appendChild(o),o.classList.add("present_opponent"),o.innerHTML=t+" "+e})),y.addEventListener("click",(function(){h.innerHTML="";for(var t=0,e=v.length,a=[],n=[],o=[],r=[],i=[],c=[],p=0;p<35;p++)for(var s=0;s<e;s++)if(v[s].Init==30-p){r.push(v[s]),++t;var d=document.createElement("div");h.appendChild(d),d.classList.add("present_opponent"),d.innerHTML=t+"<span class = present_opponent id = "+t+"present_opponent>"+v[s].name+" <span class = present_opponent_init id = "+t+"present_opponent_init alt = "+t+"> "+v[s].CA+"</span> <span class = present_opponent_hp id = "+t+"present_opponent_hp alt = "+t+"> "+v[s].HP+"</span> <input type=input class = dammage_input id = "+t+"dammage_input alt = "+t+"> <input type=submit value=take_damage id = "+t+"take_damage alt = "+t+"> <input type=submit value=attack class = generat_attack id = "+t+"attack alt = "+t+"> </span> <input type=input class = character_effect id = "+t+"effect_note value = no_temporary_effect alt = "+t+">",a.push(document.getElementById(t+"attack")),n.push(document.getElementById(t+"take_damage")),o.push(document.getElementById(t+"dammage_input")),i.push(document.getElementById(t+"present_opponent_hp")),c.push(document.getElementById(t+"present_opponent"))}for(var l=function(t){a[t].addEventListener("click",(function(){var e=function(t){var e=Math.random();if(t.attack1_proba>e){var a=Math.floor(20*Math.random()+1)+t.attack1_touch,n=Math.floor(Math.random()*(t.attack1_max-t.attack1_min+1)+t.attack1_min);return t.name+" attack with "+t.attack1+" with a touch score of "+a+" and inflict "+n+" damages"}var o=Math.floor(20*Math.random()+1)+t.attack2_touch,r=Math.floor(Math.random()*(t.attack2_max-t.attack1_min+1)+t.attack2_min);return t.name+" attack with "+t.attack2+" with a touch score of "+o+" and inflict "+r+" damages"}(r[t]);console.log(e),b.textContent=e})),n[t].addEventListener("click",(function(){var e=o[t].value,a=r[t].HP-e;r[t].HP=a,console.log(a),i[t].textContent=a,a<1&&(c[t].innerHTML="")}))},u=0;u<e;u++)l(u);console.log(document.getElementById(t+"present_opponent_init"))})),E.addEventListener("click",(function(){for(var t,e,a,n=v.length,o=[],r=[],i=0,c=0,p=0;p<n;p++){console.log("on genere le loot de "+v[p].name);var s=v[p].drop_object1,d=0;if(v[p].proba1>Math.random()){for(var l=0;l<o.length+1;l++)s==o[l]&&(loot_quantity=r[l],++loot_quantity,r[l]=loot_quantity,d=1);"0"==d&&(o.push(s),r.push(1))}var h=v[p].drop_object2,u=0;if(v[p].proba2>Math.random()){for(var _=0;_<o.length+1;_++)h==o[_]&&(loot_quantity=r[_],++loot_quantity,r[_]=loot_quantity,u=1);"0"==u&&(o.push(h),r.push(1))}var m=v[p].drop_coin;i+=Math.floor(Math.random()*m+1),c+=v[p].drop_xp}t=i-400*(a=Math.floor(i/400))-20*(e=Math.floor(i/20)-20*a);for(var f=" ",g=0;g<o.length;g++)f=f+" / "+r[g]+" "+o[g];f="On gagne un total de "+c+" XP ainsi que "+i+" PC soit "+a+" PO  "+e+" PA  "+t+" PC  "+f,b.textContent=f}))})();